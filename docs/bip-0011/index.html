<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.56">
<title data-react-helmet="true">BIP-0011 | Bitcoin Improvement Proposals </title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="BIP-0011 | Bitcoin Improvement Proposals "><meta data-react-helmet="true" name="description" content="`"><meta data-react-helmet="true" property="og:description" content="`"><meta data-react-helmet="true" property="og:url" content="https://anoop-b.github.io/BIPS_website/docs/bip-0011"><link data-react-helmet="true" rel="shortcut icon" href="https://github.com/bitcoin.png"><link data-react-helmet="true" rel="canonical" href="https://anoop-b.github.io/BIPS_website/docs/bip-0011"><link rel="stylesheet" href="/BIPS_website/styles.63f65bdd.css">
<link rel="preload" href="/BIPS_website/styles.7a6f2b0f.js" as="script">
<link rel="preload" href="/BIPS_website/runtime~main.aa600546.js" as="script">
<link rel="preload" href="/BIPS_website/main.336e2cd5.js" as="script">
<link rel="preload" href="/BIPS_website/1.95d11e1b.js" as="script">
<link rel="preload" href="/BIPS_website/2.c194322c.js" as="script">
<link rel="preload" href="/BIPS_website/18.7eb23d33.js" as="script">
<link rel="preload" href="/BIPS_website/8357b7eb.65e624de.js" as="script">
<link rel="preload" href="/BIPS_website/e25f97f5.e3bd0fa0.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/BIPS_website/"><img class="navbar__logo" src="https://upload.wikimedia.org/wikipedia/commons/4/46/Bitcoin.svg" alt="BIPS Logo"><strong class="navbar__title">BIPS</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/BIPS_website/docs/doc0">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/anoop-b/BIPS_website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/BIPS_website/"><img class="navbar__logo" src="https://upload.wikimedia.org/wikipedia/commons/4/46/Bitcoin.svg" alt="BIPS Logo"><strong class="navbar__title">BIPS</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/BIPS_website/docs/doc0">Docs</a></li><li class="menu__list-item"><a href="https://github.com/anoop-b/BIPS_website" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">BIPS</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/BIPS_website/docs/doc0">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/BIPS_website/docs/bip-0001">BIP-0001</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/BIPS_website/docs/bip-0002">BIP-0002</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/BIPS_website/docs/bip-0008">BIP-0008</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/BIPS_website/docs/bip-0009">BIP-0009</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/BIPS_website/docs/bip-0010">BIP-0010</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/BIPS_website/docs/bip-0011">BIP-0011</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/BIPS_website/docs/bip-0012">BIP-0012</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contribute</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/BIPS_website/docs/contribute">Contribution</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">BIP-0011</h1></header><div class="markdown"><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> BIP: 11</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Layer: Applications</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Title: M-of-N Standard Transactions</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Author: Gavin Andresen &amp;lt;gavinandresen@gmail.com&amp;gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Comments-Summary: No comments yet.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Comments-URI: https://github.com/bitcoin/bips/wiki/Comments:BIP-0011</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Status: Final</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Type: Standards Track</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Created: 2011-10-18</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Post-History: 2011-10-02</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="abstract"></a>Abstract<a aria-hidden="true" tabindex="-1" class="hash-link" href="#abstract" title="Direct link to heading">#</a></h2><p>This BIP proposes M-of-N-signatures required transactions as a new &#x27;standard&#x27; transaction type.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="motivation"></a>Motivation<a aria-hidden="true" tabindex="-1" class="hash-link" href="#motivation" title="Direct link to heading">#</a></h2><p>Enable secured wallets, escrow transactions, and other use cases where redeeming funds requires more than a single signature.</p><p>A couple of motivating use cases:</p><ul><li>A wallet secured by a &quot;wallet protection service&quot; (WPS). 2-of-2
signatures required transactions will be used, with one signature
coming from the (possibly compromised) computer with the wallet and the
second signature coming from the WPS. When sending protected bitcoins,
the user&#x27;s bitcoin client will contact the WPS with the proposed
transaction and it can then contact the user for confirmation that they
initiated the transaction and that the transaction details are correct.
Details for how clients and WPS&#x27;s communicate are outside the scope of
this BIP. Side note: customers should insist that their wallet
protection service provide them with copies of the private key(s) used
to secure their wallets that they can safely store off-line, so that
their coins can be spent even if the WPS goes out of business.</li><li>Three-party
escrow (buyer, seller, and trusted dispute agent). 2-of-3 signatures
required transactions will be used. The buyer and seller and agent will
each provide a public key, and the buyer will then send coins into a
2-of-3 CHECKMULTISIG transaction and send the seller and the agent the
transaction id. The seller will fulfill their obligation and then ask
the buyer to co-sign a transaction ( already signed by seller ) that
sends the tied-up coins to him (seller).<br>If the buyer and seller
cannot agree, then the agent can, with the cooperation of either buyer
or seller, decide what happens to the tied-up coins. Details of how
buyer, seller, and agent communicate to gather signatures or public keys
are outside the scope of this BIP.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="specification"></a>Specification<a aria-hidden="true" tabindex="-1" class="hash-link" href="#specification" title="Direct link to heading">#</a></h2><p>A new standard transaction type (scriptPubKey) that is relayed by clients and included in mined blocks:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">m {pubkey}...{pubkey} n OP_CHECKMULTISIG</span></div></div></div></div></div><p>But only for n less than or equal to 3.</p><p>OP_CHECKMULTISIG transactions are redeemed using a standard scriptSig:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">OP_0 ...signatures...</span></div></div></div></div></div><p>(OP_0 is required because of a bug in OP_CHECKMULTISIG; it pops one
too many items off the execution stack, so a dummy value must be placed
on the stack).</p><p>The current Satoshi bitcoin client does not relay or mine
transactions with scriptSigs larger than 200 bytes; to accommodate
3-signature transactions, this will be increased to 500 bytes.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="rationale"></a>Rationale<a aria-hidden="true" tabindex="-1" class="hash-link" href="#rationale" title="Direct link to heading">#</a></h2><p>OP_CHECKMULTISIG is already an enabled opcode, and is the most straightforward way to support several important use cases.</p><p>One argument against using OP_CHECKMULTISIG is that old clients and
miners count it as &quot;20 sigops&quot; for purposes of computing how many
signature operations are in a block, and there is a hard limit of 20,000
sigops per block-- meaning a maximum of 1,000 multisig transactions per
block. Creating multisig transactions using multiple OP_CHECKSIG
operations allows more of them per block.</p><p>The counter-argument is that these new multi-signature transactions
will be used in combination with OP_EVAL (see the OP_EVAL BIP), and <strong>will</strong> be counted accurately. And in any case, as transaction volume rises the
hard-coded maximum block size will have to be addressed, and the rules
for counting number-of-signature-operations-in-a-block can be addressed
at that time.</p><p>A weaker argument is OP_CHECKMULTISIG should not be used because it
pops one too many items off the stack during validation. Adding an extra
OP_0 placeholder to the scriptSig adds only 1 byte to the transaction,
and any alternative that avoids OP_CHECKMULTISIG adds at least several
bytes of opcodes.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="implementation"></a>Implementation<a aria-hidden="true" tabindex="-1" class="hash-link" href="#implementation" title="Direct link to heading">#</a></h2><p>OP_CHECKMULTISIG is already supported by old clients and miners as a non-standard transaction type.</p><p><a href="https://github.com/gavinandresen/bitcoin-git/tree/op_eval" target="_blank" rel="noopener noreferrer">https://github.com/gavinandresen/bitcoin-git/tree/op_eval</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="post-history"></a>Post History<a aria-hidden="true" tabindex="-1" class="hash-link" href="#post-history" title="Direct link to heading">#</a></h2><ul><li><a href="https://bitcointalk.org/index.php?topic=46538">OP_EVAL proposal</a></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/anoop-b/BIPS_website/edit/master/docs/bip-0011.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/BIPS_website/docs/bip-0010"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« BIP-0010</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/BIPS_website/docs/bip-0012"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">BIP-0012 Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#abstract" class="table-of-contents__link">Abstract</a></li><li><a href="#motivation" class="table-of-contents__link">Motivation</a></li><li><a href="#specification" class="table-of-contents__link">Specification</a></li><li><a href="#rationale" class="table-of-contents__link">Rationale</a></li><li><a href="#implementation" class="table-of-contents__link">Implementation</a></li><li><a href="#post-history" class="table-of-contents__link">Post History</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/BIPS_website/docs/doc0">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/BIPS_website/docs/contribute">Contribute</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/bitcoin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://bitcoin.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Official Website</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/bitcoin/bips" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Created For the ðŸ’™ of Bitcoin</div></div></div></footer></div>
<script src="/BIPS_website/styles.7a6f2b0f.js"></script>
<script src="/BIPS_website/runtime~main.aa600546.js"></script>
<script src="/BIPS_website/main.336e2cd5.js"></script>
<script src="/BIPS_website/1.95d11e1b.js"></script>
<script src="/BIPS_website/2.c194322c.js"></script>
<script src="/BIPS_website/18.7eb23d33.js"></script>
<script src="/BIPS_website/8357b7eb.65e624de.js"></script>
<script src="/BIPS_website/e25f97f5.e3bd0fa0.js"></script>
</body>
</html>